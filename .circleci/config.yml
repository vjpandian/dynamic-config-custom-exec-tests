version: 2.1
setup: true
orbs:
  path-filtering: vjpandian/path-filtering-orb@1.1.4
  continuation: vjpandian/continuation@1.1.0
workflows:
  setup-workflow:
    jobs:
      - path-filtering/filter-private-docker-executor:
          pre-steps:
            - checkout
            - run:
                name: print some pre-step here
                command: |
                  echo "hello"
          base-revision: private-auth
          circleci_domain: circleci.com
          dockerhub-username: $ARTIFACTORY_USER
          dockerhub-password: $ARTIFACTORY_PASSWORD
          registry: "vjpandian1818"
          image: "vjpandian"
          tag: "cimg-python"
          config-path: .circleci/continue-config.yml
          context: artifactory-creds
          mapping: |
            terraform/.* tf-deploy true
            helm/.* helm-deploy true
      - continuation/continue-private-docker-executor:
          #circleci_domain: circle.ci.adobe.com
          dockerhub-username: $ARTIFACTORY_USER
          dockerhub-password: $ARTIFACTORY_PASSWORD
          registry: "vjpandian1818"
          image: "vjpandian"
          tag: "cimg-python"
          circleci_domain: circleci.com
          configuration_path: .circleci/workflows.yml
          parameters: '{ "force": true }'
          context: artifactory-creds
